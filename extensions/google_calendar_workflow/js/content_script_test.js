// Usage:
//   $ node ./content_script_test.js

'use strict';

var GoogleCalendarMoveToDate = require('./google_calendar_move_to_date.js');

const DEBUG = true;
const TEST_ENV = 'TEST';
const PROD_ENV = 'PROD';


// Sep 22, 2019 - Oct 19, 2019 (weeks).
const TEST_OLDER_CELL_DATES = [
    [
        'Sep 22, 2019',
        'Sep 23, 2019',
        'Sep 24, 2019',
        'Sep 25, 2019',
        'Sep 26, 2019',
        'Sep 27, 2019',
        'Sep 28, 2019',
    ],
    [
        'Sep 29, 2019',
        'Sep 30, 2019',
        'Oct 1, 2019',
        'Oct 2, 2019',
        'Oct 3, 2019',
        'Oct 4, 2019',
        'Oct 5, 2019',
    ],
    [
        'Oct 6, 2019',
        'Oct 7, 2019',
        'Oct 8, 2019',
        'Oct 9, 2019',
        'Oct 10, 2019',
        'Oct 11, 2019',
        'Oct 12, 2019',
    ],
    [
        'Oct 13, 2019',
        'Oct 14, 2019',
        'Oct 15, 2019',
        'Oct 16, 2019',
        'Oct 17, 2019',
        'Oct 18, 2019',
        'Oct 19, 2019',
    ],
];
// Oct 20, 2019 - Nov 16, 2019 (4 weeks).
const TEST_CELL_DATES = [
    [
        'Oct 20, 2019',
        'Oct 21, 2019',
        'Oct 22, 2019',
        'Oct 23, 2019',
        'Oct 24, 2019',
        'Oct 25, 2019',
        'Oct 26, 2019',
    ],
    [
        'Oct 27, 2019',
        'Oct 28, 2019',
        'Oct 29, 2019',
        'Oct 30, 2019',
        'Oct 31, 2019',
        'Nov 1, 2019',
        'Nov 2, 2019',
    ],
    [
        'Nov 3, 2019',
        'Nov 4, 2019',
        'Nov 5, 2019',
        'Nov 6, 2019',
        'Nov 7, 2019',
        'Nov 8, 2019',
        'Nov 9, 2019',
    ],
    [
        'Nov 10, 2019',
        'Nov 11, 2019',
        'Nov 12, 2019',
        'Nov 13, 2019',
        'Nov 14, 2019',
        'Nov 15, 2019',
        'Nov 16, 2019',
    ],
];
// Nov 17, 2019 - Dec 14, 2019 (weeks).
const TEST_NEWER_CELL_DATES = [
    [
        'Nov 17, 2019',
        'Nov 18, 2019',
        'Nov 19, 2019',
        'Nov 20, 2019',
        'Nov 21, 2019',
        'Nov 22, 2019',
        'Nov 23, 2019',
    ],
    [
        'Nov 24, 2019',
        'Nov 25, 2019',
        'Nov 26, 2019',
        'Nov 27, 2019',
        'Nov 28, 2019',
        'Nov 29, 2019',
        'Nov 30, 2019',
    ],
    [
        'Dec 1, 2019',
        'Dec 2, 2019',
        'Dec 3, 2019',
        'Dec 4, 2019',
        'Dec 5, 2019',
        'Dec 6, 2019',
        'Dec 7, 2019',
    ],
    [
        'Dec 8, 2019',
        'Dec 9, 2019',
        'Dec 10, 2019',
        'Dec 11, 2019',
        'Dec 12, 2019',
        'Dec 13, 2019',
        'Dec 14, 2019',
    ],
];

const TESTS = [
    {
        // Top row contains no entries in any cell -> Use right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 6],
        'expected_cell_date': 'Oct 26, 2019',
    },
    {
        // Top row contains 1 entry in top right cell -> Use right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 6],
        'expected_cell_date': 'Oct 26, 2019',
    },
    {
        // Top row contains 13 entries in top right cell -> Use right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 6],
        'expected_cell_date': 'Oct 26, 2019',
    },
    {
        // Top row contains 14 entries in top right cell, cell to left is empty -> Use 2nd to right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 5],
        'expected_cell_date': 'Oct 25, 2019',
    },
    {
        // Top row contains 14 entries in top right cell, cell to left contains 1 entry -> Use 2nd to right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [],
                [''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 5],
        'expected_cell_date': 'Oct 25, 2019',
    },
    {
        // Top row contains 14 entries in top right cell, cell to left contains 13 entries -> Use 2nd to right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 5],
        'expected_cell_date': 'Oct 25, 2019',
    },
    {
        // Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left is empty -> Use 3rd to right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 4],
        'expected_cell_date': 'Oct 24, 2019',
    },
    {
        // Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left contains 1 entry -> Use 3rd to right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                [''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 4],
        'expected_cell_date': 'Oct 24, 2019',
    },
    {
        // Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left contains 13 entries -> Use 3rd to right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 4],
        'expected_cell_date': 'Oct 24, 2019',
    },
    {
        // Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left contains 14 entries, cell to left is empty -> Use 4th to right-most cell.
        'cells': [
            [
                [],
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 3],
        'expected_cell_date': 'Oct 23, 2019',
    },
    {
        'cells': [
            [
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 3],
        'expected_cell_date': 'Oct 23, 2019',
    },
    {
        'cells': [
            [
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 2],
        'expected_cell_date': 'Oct 22, 2019',
    },
    {
        'cells': [
            [
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 2],
        'expected_cell_date': 'Oct 22, 2019',
    },
    {
        'cells': [
            [
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 1],
        'expected_cell_date': 'Oct 21, 2019',
    },
    {
        'cells': [
            [
                [],
                [''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 1],
        'expected_cell_date': 'Oct 21, 2019',
    },
    {
        'cells': [
            [
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 1],
        'expected_cell_date': 'Oct 21, 2019',
    },
    {
        'cells': [
            [
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 0],
        'expected_cell_date': 'Oct 20, 2019',
    },
    {
        'cells': [
            [
                [''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 0],
        'expected_cell_date': 'Oct 20, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [0, 0],
        'expected_cell_date': 'Oct 20, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [1, 6],
        'expected_cell_date': 'Nov 2, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [1, 6],
        'expected_cell_date': 'Nov 2, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [1, 5],
        'expected_cell_date': 'Nov 1, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [1, 0],
        'expected_cell_date': 'Oct 27, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [2, 6],
        'expected_cell_date': 'Nov 9, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                [],
                [],
                [],
                [],
                [],
                [],
                [],
            ],
        ],
        'expected_top_cell': [3, 6],
        'expected_cell_date': 'Nov 16, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
        ],
        'expected_top_cell': [3, 0],
        'expected_cell_date': 'Nov 10, 2019',
    },
    {
        'cells': [
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
            [
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
                ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ],
        ],
        'expected_top_cell': undefined,
        'expected_cell_date': undefined,
    },
];

var allTestsPass = true;
for (var i = 0; i < TESTS.length; i++) {
    console.log('--------------------------------------------------------------------------------');
    console.log(i);
    var test = TESTS[i];
    var cells = test['cells'];
    var expectedTopCell = test['expected_top_cell'];
    var expectedTopCellForComparison = expectedTopCell;
    if (expectedTopCellForComparison && typeof expectedTopCellForComparison.toString === 'function') {
        expectedTopCellForComparison = expectedTopCellForComparison.toString();
    }
    var expectedCellDate = test['expected_cell_date'];

    var moveToDate = new GoogleCalendarMoveToDate({
        'debug': DEBUG,
        'env': TEST_ENV,
        'cellDates': TEST_CELL_DATES,
    });
    var topCell = moveToDate.findTopCell(cells);
    var topCellForComparison = topCell;
    if (topCellForComparison && typeof topCellForComparison.toString === 'function') {
        topCellForComparison = topCellForComparison.toString();
    }
    allTestsPass = allTestsPass && topCellForComparison === expectedTopCellForComparison;

    if (topCell !== undefined) {
        var cellDate = moveToDate.getCellDate(topCell);
        allTestsPass = allTestsPass && cellDate === expectedCellDate;
    }

    if (!allTestsPass) {
        console.log('********************************************************************************');
        console.log('test has failed');
        if (topCellForComparison !== expectedTopCellForComparison) {
            console.log('expected top cell:', expectedTopCellForComparison);
            console.log('actual top cell:', topCellForComparison);
        }
        if (cellDate !== expectedCellDate) {
            console.log('expected cell date:', expectedCellDate);
            console.log('actual cell date:', cellDate);
        }
        console.log('********************************************************************************');
        break;
    }
}

// === Additional test case 1. ================================================
// load current calendar dates
var moveToDate = new GoogleCalendarMoveToDate({
    'debug': DEBUG,
    'env': TEST_ENV,
    'cellDates': TEST_CELL_DATES,
});
// get top cell date
var topCellDate = moveToDate.getTopCellDate(
    [
        [
            [],
            [],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell date should be first available top-right-most date
allTestsPass = allTestsPass && topCellDate === 'Oct 21, 2019';

// load newer calendar dates
moveToDate.options.cellDates = TEST_NEWER_CELL_DATES;
// get top cell date
topCellDate = moveToDate.getTopCellDate(
    [
        [
            [],
            [],
            [],
            [],
            [],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell date should not change (should be the originally calculated top cell date)
allTestsPass = allTestsPass && topCellDate === 'Oct 21, 2019';

// load older calendar dates
moveToDate.options.cellDates = TEST_OLDER_CELL_DATES;
// get top cell date
topCellDate = moveToDate.getTopCellDate(
    [
        [
            [],
            [],
            [],
            [],
            [],
            [],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell date should be first available top-right-most date (older than the originally calculated top cell date).
allTestsPass = allTestsPass && topCellDate === 'Sep 27, 2019';

// === Additional test case 2. ================================================
// load current calendar dates
var moveToDate = new GoogleCalendarMoveToDate({
    'debug': DEBUG,
    'env': TEST_ENV,
    'cellDates': TEST_CELL_DATES,
});
// all cells filled except 1.
// get top cell date.
var topCellDate = moveToDate.getTopCellDate(
    [
        [
            ['', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell should be first available top-right-most date (Oct 20, 2019).
allTestsPass = allTestsPass && topCellDate === 'Oct 20, 2019';
// all cells filled (simulating a task has been marked completed).
// get top cell date.
topCellDate = moveToDate.getTopCellDate(
    [
        [
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
            ['', '', '', '', '', '', '', '', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell should be Nov 2, 2019 (not original oldest top cell of Oct 20).
allTestsPass = allTestsPass && topCellDate === 'Nov 2, 2019';

// === Additional test case 3. ================================================
// load current calendar dates
var moveToDate = new GoogleCalendarMoveToDate({
    'debug': DEBUG,
    'env': TEST_ENV,
    'cellDates': TEST_CELL_DATES,
    'maxEventsPerCell': 7,
});
// all cells filled except 1.
// get top cell date.
var topCellDate = moveToDate.getTopCellDate(
    [
        [
            ['', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell should be first available top-right-most date (Oct 20, 2019).
allTestsPass = allTestsPass && topCellDate === 'Oct 20, 2019';
// all cells filled (simulating a task has been marked completed).
// get top cell date.
topCellDate = moveToDate.getTopCellDate(
    [
        [
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell should be Nov 2, 2019 (not original oldest top cell of Oct 20).
allTestsPass = allTestsPass && topCellDate === 'Nov 2, 2019';
// all cells filled except 1 in second row.
// get top cell date.
topCellDate = moveToDate.getTopCellDate(
    [
        [
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
        ],
        [
            ['', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell should be first available top-right-most date (Oct 27, 2019).
allTestsPass = allTestsPass && topCellDate === 'Oct 27, 2019';
// all cells filled (simulating a task has been marked completed).
// get top cell date.
topCellDate = moveToDate.getTopCellDate(
    [
        [
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
        ],
        [
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
            ['', '', '', '', '', '', ''],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
        [
            [],
            [],
            [],
            [],
            [],
            [],
            [],
        ],
    ]
);
// top cell should be Nov 9, 2019.
allTestsPass = allTestsPass && topCellDate === 'Nov 9, 2019';

console.log('tests found:', TESTS.length);

// Cases:
//   Top row contains no entries in any cell -> Use right-most cell.
//   Top row contains 1 entry in top right cell -> Use right-most cell.
//   Top row contains 13 entries in top right cell -> Use right-most cell.
//   Top row contains 14 entries in top right cell, cell to left is empty -> Use 2nd to right-most cell.
//   Top row contains 14 entries in top right cell, cell to left contains 1 entry -> Use 2nd to right-most cell.
//   Top row contains 14 entries in top right cell, cell to left contains 13 entries -> Use 2nd to right-most cell.
//   Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left is empty -> Use 3rd to right-most cell.
//   Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left contains 1 entry -> Use 3rd to right-most cell.
//   Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left contains 13 entries -> Use 3rd to right-most cell.
//   Top row contains 14 entries in top right cell, cell to left contains 14 entries, cell to left contains 14 entries, cell to left is empty -> Use 4th to right-most cell.
//   (repeat)
// Use oldest date found.

allTestsPass = allTestsPass && moveToDate.getEventDateFormattedDate('2021-02-01') === '2021-02-01';


var moveToDateDate = new Date(2022, 0, 1);
var eventDate = 'Jan 10, 2022';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '- Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '-',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === 'Do thing';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ 'Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '1.',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '1. Do thing';


allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '*** 1. Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '1.',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '*** Do thing';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '*** Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '1.',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '*** 1. Do thing';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ 'Tentative: Do thing',
    /* action */ 'mark-completed',
    /* eventTitlePrefix */ '✓',
    /* eventCompleted */ true,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '✓ Do thing; Jan 1, 2022; event date: Jan 10, 2022';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '*** ↻ Tentative: Go to a coffee shop for a change of scenery ***',
    /* action */ 'mark-completed',
    /* eventTitlePrefix */ '✓',
    /* eventCompleted */ true,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '✓ *** ↻ Go to a coffee shop for a change of scenery ***; Jan 1, 2022; event date: Jan 10, 2022';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ 'Tentative: Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '✓',
    /* eventCompleted */ true,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '✓ Do thing; Jan 1, 2022; event date: Jan 10, 2022';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '~ Pay day (↻)',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '-',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '- Pay day (↻)';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '3. - Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '-',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '- Do thing';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ 'Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '*',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '*** Do thing';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '*** Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '*',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === 'Do thing';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '1. Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '*',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '*** 1. Do thing';

allTestsPass = allTestsPass && moveToDate.getNewEventTitle(
    /* originalCalendarEventTitle */ '*** 1. Do thing',
    /* action */ 'toggle-prefix',
    /* eventTitlePrefix */ '*',
    /* eventCompleted */ false,
    /* eventDate */ eventDate,
    /* date */ moveToDateDate,
) === '1. Do thing';

console.log('\nallTestsPass:', allTestsPass);
